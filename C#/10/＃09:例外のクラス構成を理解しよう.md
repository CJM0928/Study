## 例外のクラス構成を理解しよう (C# Exception 클래스 계층 구조)

### C# 의 예외 클래스는 계층 구조(상속)로 구성되어 있음:
```
Exception
 └── SystemException
      ├── IndexOutOfRangeException
      ├── ArithmeticException
      │     └── DivideByZeroException
      └── ArgumentException
            └── ArgumentNullException
```

즉,

- 하위 예외는 상위 예외의 일종
  - catch 블록은 위에서부터 타입이 일치하는 첫 블록이 실행
  - 상위 타입의 catch 가 앞에 오면 하위 catch는 절대 도달하지 않음
    
- 그래서 실무에서는 항상:
  - 구체적인 예외 → 위
  - 일반적인 예외(Exception) → 맨 아래

> 이 순서를 지켜야 한다.

---

### 예제 코드 + 해설
```
using System;

class Lesson10
{
    public static void Main()
    {
        try
        {
            // throw new Exception();                    // 4
            // throw new FormatException();             // 3
            // throw new IndexOutOfRangeException();    // 3
            // throw new DivideByZeroException();       // 2
            // throw new ArgumentNullException();       // 1
        }
        catch (ArgumentException e)
        {
            Console.WriteLine(1);
            Console.WriteLine(e);
        }
        catch (ArithmeticException e)
        {
            Console.WriteLine(2);
            Console.WriteLine(e);
        }
        catch (SystemException e)
        {
            Console.WriteLine(3);
            Console.WriteLine(e);
        }
        catch (Exception e)
        {
            Console.WriteLine(4);
            Console.WriteLine(e);
        }
    }
}
```

---

### 아래 5개의 throw 를 각각 켰을 때 어떤 catch 로 들어가는지 정리해보면

---

#### ① throw new ArgumentNullException();
> ArgumentNullException → ArgumentException 계열
```
ArgumentException (catch 1번) 에서 처리됨
```

> 출력:
```
1
System.ArgumentNullException: ...
```

---

#### ② throw new DivideByZeroException();
> DivideByZeroException → ArithmeticException 계열
```
ArithmeticException (catch 2번) 에서 처리됨
```

출력:
```
2
System.DivideByZeroException: ...
```

---

#### ③ throw new IndexOutOfRangeException();
> IndexOutOfRangeException → SystemException 계열
```
SystemException (catch 3번) 에서 처리됨
```

출력:
```
3
System.IndexOutOfRangeException: ...
```

---

#### ④ throw new FormatException();
> FormatException → SystemException 계열 (ArgumentException X)

```
SystemException (catch 3번) 실행됨
```

출력:
```
3
System.FormatException: ...
```

---

#### ⑤ throw new Exception();
> Exception → 최상위 타입
```
catch (Exception e) (catch 4번) 실행됨
```

출력:
```
4
System.Exception: ...
```

---

### catch 우선순위 정리

| 예외 종류                      | 상속 계층                           | 도달하는 catch |
| -------------------------- | ------------------------------- | ---------- |
| `ArgumentNullException`    | Argument → System → Exception   | catch 1    |
| `DivideByZeroException`    | Arithmetic → System → Exception | catch 2    |
| `IndexOutOfRangeException` | System → Exception              | catch 3    |
| `FormatException`          | System → Exception              | catch 3    |
| `Exception`                | Exception                       | catch 4    |

---

### 주의: catch 순서는 절대 반대로 하면 안 됨
> 아래처럼 작성하면 컴파일 에러 발생
```
catch (Exception e)
catch (ArgumentException e)
```

왜?
- Exception 이 모든 예외의 부모이므로
  - 그 아래에 오면 ArgumentException은 절대 실행될 수 없기 때문

---

### Java에서의 Exception 계층도 유사함
> Java 기본 구조:

```
Throwable
 ├── Exception
 │     ├── RuntimeException
 │     │     ├── ArithmeticException
 │     │     ├── NullPointerException
 │     │     ├── IndexOutOfBoundsException
 │     │     └── NumberFormatException
 └── Error  (catch 하지 않는 영역)
```
> 즉, C#과 거의 동일한 개념이지만 루트가 Throwable 이라는 점이 다름.
